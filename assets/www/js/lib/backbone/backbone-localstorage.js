function S4(){return((1+Math.random())*65536|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}var Store=function(a){this.name=a;var b=localStorage.getItem(this.name);this.data=b&&JSON.parse(b)||{}};_.extend(Store.prototype,{save:function(){localStorage.setItem(this.name,JSON.stringify(this.data))},create:function(a){return a.id||a.set(a.idAttribute,guid()),this.data[a.id]=a,this.save(),a},update:function(a){return this.data[a.id]=a,this.save(),a},find:function(a){return this.data[a.id]},findAll:function(){return _.values(this.data)},destroy:function(a){return delete this.data[a.id],this.save(),a}}),Backbone.sync=function(a,b,c){var d,e=b.localStorage||b.collection.localStorage;switch(a){case"read":d=b.id?e.find(b):e.findAll();break;case"create":d=e.create(b);break;case"update":d=e.update(b);break;case"delete":d=e.destroy(b)}d?c.success(d):c.error("Record not found")}